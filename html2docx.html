<script type="text/html" data-template-name="html2docx">
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name" placeholder="Name" />
  </div>
  <div class="form-row">
    <label for="node-input-output"><i class="fa fa-print"></i> Output</label>
    <select id="node-input-output">
      <option>Filepath</option>
      <option>Buffer</option>
    </select>
  </div>
</script>

<script type="text/html" data-help-name="html2docx">
  <p>
    A function that converts the HTML found in <code>msg.payload</code> to PDF,
    using the <strong>Puppeteer</strong> library.
  </p>
  <h3>Inputs</h3>
  <dl class="message-properties">
    <dt>payload <span class="property-type">string</span></dt>
    <dd>The HTML source code.</dd>
  </dl>

  <h3>Outputs</h3>

  <dl class="message-properties">
    <dt>payload <span class="property-type">buffer</span></dt>
    <dd>The PDF.</dd>
  </dl>

  <h3>Details</h3>

  <p>Various options can be set in the node configuration dialog:</p>
  <ul>
    <li>
      Format (letter, legal, tabloid, ledger, A0, A1, A2, A3, A4, A5, A6,
      custom)
    </li>
    <li>Orientation (portrait, landscape)</li>
    <li>Zoom (10% to 200%)</li>
    <li>Margins</li>
    <li>Transparent background</li>
    <li>Show or hide background graphics</li>
  </ul>

  <h3>References</h3>

  <ul>
    <li>
      <a href="https://pptr.dev/">Puppeteer</a> - details of the
      <strong>Puppeteer</strong> library
    </li>
  </ul>
</script>

<script type="text/javascript">
  RED.nodes.registerType("html2docx", {
    category: "function",
    color: "#E9967A",
    defaults: {
      name: { value: "" },
      output: { value: "Buffer" },
    },
    inputs: 1,
    outputs: 1,
    icon: "html2docx.svg",
    label: function () {
      return this.name || "html to pdf";
    },
    labelStyle: function () {
      return this.name ? "node_label_italic" : "";
    },
    paletteLabel: "html to pdf",
    oneditprepare: () => {
    },
  });
</script>